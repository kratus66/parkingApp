import { MigrationInterface, QueryRunner } from "typeorm";

export class CreateParkingLotCounters1768504187952 implements MigrationInterface {
    name = 'CreateParkingLotCounters1768504187952'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "audit_logs" DROP CONSTRAINT "FK_audit_logs_company"`);
        await queryRunner.query(`ALTER TABLE "audit_logs" DROP CONSTRAINT "FK_audit_logs_parking_lot"`);
        await queryRunner.query(`ALTER TABLE "audit_logs" DROP CONSTRAINT "FK_audit_logs_actor_user"`);
        await queryRunner.query(`ALTER TABLE "users" DROP CONSTRAINT "FK_users_company"`);
        await queryRunner.query(`ALTER TABLE "users" DROP CONSTRAINT "FK_users_parking_lot"`);
        await queryRunner.query(`ALTER TABLE "tickets" DROP CONSTRAINT "FK_b919a0e8391a5bb96e9ee392fbe"`);
        await queryRunner.query(`ALTER TABLE "tickets" DROP CONSTRAINT "FK_3023efeb0eba7982352d958ef42"`);
        await queryRunner.query(`ALTER TABLE "parking_lots" DROP CONSTRAINT "FK_parking_lots_company"`);
        await queryRunner.query(`ALTER TABLE "consents" DROP CONSTRAINT "consents_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "consents" DROP CONSTRAINT "consents_customer_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "consents" DROP CONSTRAINT "consents_actor_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "customers" DROP CONSTRAINT "customers_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" DROP CONSTRAINT "vehicles_v2_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" DROP CONSTRAINT "vehicles_v2_customer_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" DROP CONSTRAINT "ticket_templates_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" DROP CONSTRAINT "ticket_templates_parking_lot_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_zones" DROP CONSTRAINT "FK_parking_zones_company"`);
        await queryRunner.query(`ALTER TABLE "parking_zones" DROP CONSTRAINT "FK_parking_zones_parking_lot"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "FK_parking_spots_company"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "FK_parking_spots_parking_lot"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "FK_parking_spots_zone"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_parking_lot_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_customer_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_vehicle_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_spot_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_created_by_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_closed_by_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "parking_sessions_canceled_by_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "ticket_print_logs_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "ticket_print_logs_parking_lot_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "ticket_print_logs_parking_session_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "ticket_print_logs_actor_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_spot_status_history_company"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_spot_status_history_parking_lot"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_spot_status_history_spot"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_spot_status_history_actor"`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" DROP CONSTRAINT "parking_lot_counters_parking_lot_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "notification_logs_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "notification_logs_parking_lot_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "notification_logs_customer_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "notification_logs_vehicle_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "notification_logs_parking_session_id_fkey"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_audit_logs_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_audit_logs_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_audit_logs_actor_user_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_audit_logs_entity_name"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_audit_logs_created_at"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_users_email"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_users_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_users_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_tickets_vehicle_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_tickets_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_tickets_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_tickets_entry_time"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_lots_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_companies_name"`);
        await queryRunner.query(`DROP INDEX "public"."idx_vehicles_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_vehicles_license_plate"`);
        await queryRunner.query(`DROP INDEX "public"."idx_consents_customer_channel"`);
        await queryRunner.query(`DROP INDEX "public"."idx_consents_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_customers_document_number"`);
        await queryRunner.query(`DROP INDEX "public"."idx_customers_full_name"`);
        await queryRunner.query(`DROP INDEX "public"."idx_customers_phone"`);
        await queryRunner.query(`DROP INDEX "public"."idx_customers_email"`);
        await queryRunner.query(`DROP INDEX "public"."idx_vehicles_v2_plate"`);
        await queryRunner.query(`DROP INDEX "public"."idx_vehicles_v2_bicycle_code"`);
        await queryRunner.query(`DROP INDEX "public"."idx_vehicles_v2_plate_search"`);
        await queryRunner.query(`DROP INDEX "public"."idx_vehicles_v2_bicycle_code_search"`);
        await queryRunner.query(`DROP INDEX "public"."idx_ticket_templates_parking_lot"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_zones_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_zones_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_spots_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_spots_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_spots_zone_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_spots_status"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_spots_spot_type"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_parking_spots_code"`);
        await queryRunner.query(`DROP INDEX "public"."idx_parking_sessions_parking_lot_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_parking_sessions_vehicle_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_parking_sessions_spot_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_parking_sessions_ticket_number"`);
        await queryRunner.query(`DROP INDEX "public"."idx_ticket_print_logs_session"`);
        await queryRunner.query(`DROP INDEX "public"."idx_ticket_print_logs_parking_lot"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_spot_status_history_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_spot_status_history_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_spot_status_history_spot_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_spot_status_history_created_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_parking_lot_counters_parking_lot_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_notification_logs_parking_lot"`);
        await queryRunner.query(`DROP INDEX "public"."idx_notification_logs_status"`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" DROP CONSTRAINT "check_vehicle_identifier"`);
        await queryRunner.query(`ALTER TABLE "customers" DROP CONSTRAINT "customers_company_id_document_type_document_number_key"`);
        await queryRunner.query(`ALTER TABLE "parking_zones" DROP CONSTRAINT "UQ_parking_zones_parking_lot_name"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "UQ_parking_spots_parking_lot_code"`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" RENAME COLUMN "next_ticket_number" TO "current_number"`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" DROP COLUMN "current_number"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "parking_lot_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "parking_session_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "action"`);
        await queryRunner.query(`DROP TYPE "public"."ticket_print_action_enum"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "actor_user_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "reason"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "device_name"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "customer_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "vehicle_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "entry_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "exit_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "created_by_user_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "closed_by_user_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "canceled_by_user_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "ticket_printed_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "ticket_reprinted_count"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "parking_lot_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "customer_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "vehicle_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "parking_session_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "channel"`);
        await queryRunner.query(`DROP TYPE "public"."notification_channel_enum"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "to"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "template"`);
        await queryRunner.query(`DROP TYPE "public"."notification_template_enum"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "provider"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "payload"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "created_at"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "customer_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "vehicle_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "entry_at" TIMESTAMP NOT NULL DEFAULT NOW()`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "exit_at" TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "created_by_user_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "closed_by_user_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "canceled_by_user_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "ticket_printed_at" TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "ticket_reprinted_count" integer NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "parking_lot_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "parking_session_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "action" "public"."ticket_print_action_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "actor_user_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "reason" text`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "device_name" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" ADD "next_ticket_number" integer NOT NULL DEFAULT '1'`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "parking_lot_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "customer_id" uuid`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "vehicle_id" uuid`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "parking_session_id" uuid`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "channel" "public"."notification_channel_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "to" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "template" "public"."notification_template_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "provider" character varying(100) NOT NULL DEFAULT 'mock'`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "payload" jsonb`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "created_at" TIMESTAMP NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "updated_at" TIMESTAMP NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "session_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "ticket_content" text NOT NULL`);
        await queryRunner.query(`CREATE TYPE "public"."print_type_enum" AS ENUM('ORIGINAL', 'REPRINT')`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "print_type" "public"."print_type_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "operator_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "vehicle_plate" character varying(20) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "vehicle_type" "public"."vehicle_type_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "check_in_time" TIMESTAMP NOT NULL DEFAULT NOW()`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "check_out_time" TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "duration_minutes" integer`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "operator_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "check_out_operator_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "phone_number" character varying(20)`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "email" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "notes" text`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "canceled_at" TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "canceled_by_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" ADD "current_number" integer NOT NULL DEFAULT '1'`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "session_id" uuid NOT NULL`);
        await queryRunner.query(`CREATE TYPE "public"."notification_type_enum" AS ENUM('WHATSAPP', 'EMAIL')`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "type" "public"."notification_type_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "recipient" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "subject" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "message" text NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "sent_at" TIMESTAMP NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TYPE "public"."audit_action_enum" RENAME TO "audit_action_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."audit_logs_action_enum" AS ENUM('CREATE', 'UPDATE', 'DELETE', 'RESTORE', 'LOGIN')`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ALTER COLUMN "action" TYPE "public"."audit_logs_action_enum" USING "action"::"text"::"public"."audit_logs_action_enum"`);
        await queryRunner.query(`DROP TYPE "public"."audit_action_enum_old"`);
        await queryRunner.query(`ALTER TYPE "public"."user_role_enum" RENAME TO "user_role_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."users_role_enum" AS ENUM('ADMIN', 'SUPERVISOR', 'CASHIER')`);
        await queryRunner.query(`ALTER TABLE "users" ALTER COLUMN "role" DROP DEFAULT`);
        await queryRunner.query(`ALTER TABLE "users" ALTER COLUMN "role" TYPE "public"."users_role_enum" USING "role"::"text"::"public"."users_role_enum"`);
        await queryRunner.query(`ALTER TABLE "users" ALTER COLUMN "role" SET DEFAULT 'CASHIER'`);
        await queryRunner.query(`DROP TYPE "public"."user_role_enum_old"`);
        await queryRunner.query(`ALTER TABLE "tickets" ALTER COLUMN "created_at" SET DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "tickets" ALTER COLUMN "updated_at" SET DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "vehicles" ALTER COLUMN "created_at" SET DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "vehicles" ALTER COLUMN "updated_at" SET DEFAULT now()`);
        await queryRunner.query(`ALTER TYPE "public"."consent_channel_enum" RENAME TO "consent_channel_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."consents_channel_enum" AS ENUM('WHATSAPP', 'EMAIL')`);
        await queryRunner.query(`ALTER TABLE "consents" ALTER COLUMN "channel" TYPE "public"."consents_channel_enum" USING "channel"::"text"::"public"."consents_channel_enum"`);
        await queryRunner.query(`DROP TYPE "public"."consent_channel_enum_old"`);
        await queryRunner.query(`ALTER TYPE "public"."consent_status_enum" RENAME TO "consent_status_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."consents_status_enum" AS ENUM('GRANTED', 'REVOKED')`);
        await queryRunner.query(`ALTER TABLE "consents" ALTER COLUMN "status" TYPE "public"."consents_status_enum" USING "status"::"text"::"public"."consents_status_enum"`);
        await queryRunner.query(`DROP TYPE "public"."consent_status_enum_old"`);
        await queryRunner.query(`ALTER TYPE "public"."consent_source_enum" RENAME TO "consent_source_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."consents_source_enum" AS ENUM('IN_PERSON', 'WEB', 'CALLCENTER', 'OTHER')`);
        await queryRunner.query(`ALTER TABLE "consents" ALTER COLUMN "source" TYPE "public"."consents_source_enum" USING "source"::"text"::"public"."consents_source_enum"`);
        await queryRunner.query(`DROP TYPE "public"."consent_source_enum_old"`);
        await queryRunner.query(`ALTER TYPE "public"."document_type_enum" RENAME TO "document_type_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."customers_document_type_enum" AS ENUM('CC', 'CE', 'PASSPORT', 'PPT', 'OTHER')`);
        await queryRunner.query(`ALTER TABLE "customers" ALTER COLUMN "document_type" TYPE "public"."customers_document_type_enum" USING "document_type"::"text"::"public"."customers_document_type_enum"`);
        await queryRunner.query(`DROP TYPE "public"."document_type_enum_old"`);
        await queryRunner.query(`ALTER TYPE "public"."vehicle_type_v2_enum" RENAME TO "vehicle_type_v2_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."vehicles_v2_vehicle_type_enum" AS ENUM('BICYCLE', 'MOTORCYCLE', 'CAR', 'TRUCK_BUS')`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ALTER COLUMN "vehicle_type" TYPE "public"."vehicles_v2_vehicle_type_enum" USING "vehicle_type"::"text"::"public"."vehicles_v2_vehicle_type_enum"`);
        await queryRunner.query(`DROP TYPE "public"."vehicle_type_v2_enum_old"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ALTER COLUMN "spot_id" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "UQ_89db57d0a4ef57532f9d0040ccb" UNIQUE ("ticket_number")`);
        await queryRunner.query(`ALTER TYPE "public"."notification_status_enum" RENAME TO "notification_status_enum_old"`);
        await queryRunner.query(`CREATE TYPE "public"."notification_status_enum" AS ENUM('PENDING', 'SENT', 'FAILED')`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ALTER COLUMN "status" DROP DEFAULT`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ALTER COLUMN "status" TYPE "public"."notification_status_enum" USING "status"::"text"::"public"."notification_status_enum"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ALTER COLUMN "status" SET DEFAULT 'PENDING'`);
        await queryRunner.query(`DROP TYPE "public"."notification_status_enum_old"`);
        await queryRunner.query(`CREATE INDEX "IDX_2cd10fda8276bb995288acfbfb" ON "audit_logs" ("created_at") `);
        await queryRunner.query(`CREATE INDEX "IDX_4057c4849108f6d6ccb77a4e91" ON "audit_logs" ("entity_name") `);
        await queryRunner.query(`CREATE INDEX "IDX_f160d97a931844109de9d04228" ON "audit_logs" ("actor_user_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_46fc7d733187f3afd98adfe64a" ON "audit_logs" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_50d854b973295d7c51bcf346ef" ON "audit_logs" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_06c2e305ee06aedfe649b74ef6" ON "users" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_7ae6334059289559722437bcc1" ON "users" ("company_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "IDX_97672ac88f789774dd47f7c8be" ON "users" ("email") `);
        await queryRunner.query(`CREATE INDEX "IDX_bee9424473a42c5f5abb473741" ON "parking_lots" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_3dacbb3eb4f095e29372ff8e13" ON "companies" ("name") `);
        await queryRunner.query(`CREATE INDEX "IDX_ca777b57c4b673cd7ba0e6a5cb" ON "consents" ("status") `);
        await queryRunner.query(`CREATE INDEX "IDX_94aa5f1969303fa5e12fe6b28d" ON "consents" ("customer_id", "channel") `);
        await queryRunner.query(`CREATE INDEX "IDX_8536b8b85c06969f84f0c098b0" ON "customers" ("email") `);
        await queryRunner.query(`CREATE INDEX "IDX_88acd889fbe17d0e16cc4bc917" ON "customers" ("phone") `);
        await queryRunner.query(`CREATE INDEX "IDX_bf14b22e55d577d5834fcf886b" ON "customers" ("full_name") `);
        await queryRunner.query(`CREATE INDEX "IDX_22b98dcb177bd6261887c8c959" ON "customers" ("document_number") `);
        await queryRunner.query(`CREATE INDEX "IDX_21ddbf10f881dc82b7f8b0187a" ON "vehicles_v2" ("bicycle_code") `);
        await queryRunner.query(`CREATE INDEX "IDX_155d86702a10041d294f9fde38" ON "vehicles_v2" ("plate") `);
        await queryRunner.query(`CREATE INDEX "IDX_31110f9477e968876568dc9b4a" ON "parking_zones" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_4c4edef2d4c0a70ce290a8a05a" ON "parking_zones" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_31110f9477e968876568dc9b4a" ON "parking_zones" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_4c4edef2d4c0a70ce290a8a05a" ON "parking_zones" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_f5b416c56d83c51e43806dd321" ON "parking_spots" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_0e9f64169bf505b8f113edc068" ON "parking_spots" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_94850016cd36b802800c88a47a" ON "parking_spots" ("zone_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_a1e809ee6c0f1ac5a4526c1977" ON "parking_spots" ("code") `);
        await queryRunner.query(`CREATE INDEX "IDX_3ae61187fe941f63c7804db1a0" ON "parking_spots" ("spot_type") `);
        await queryRunner.query(`CREATE INDEX "IDX_5ef9ec08f6be37cd24837fd087" ON "parking_spots" ("status") `);
        await queryRunner.query(`CREATE INDEX "IDX_94850016cd36b802800c88a47a" ON "parking_spots" ("zone_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_f5b416c56d83c51e43806dd321" ON "parking_spots" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_0e9f64169bf505b8f113edc068" ON "parking_spots" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_0778f9142420e9fbe4527a0cd8" ON "spot_status_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_ea6685b4b0acaff738b9cdfd05" ON "spot_status_history" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_f5aabc8eeb95d69daa17368d46" ON "spot_status_history" ("spot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_07bb10fe9879ba1639bf941936" ON "spot_status_history" ("created_at") `);
        await queryRunner.query(`CREATE INDEX "IDX_0778f9142420e9fbe4527a0cd8" ON "spot_status_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_ea6685b4b0acaff738b9cdfd05" ON "spot_status_history" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_f5aabc8eeb95d69daa17368d46" ON "spot_status_history" ("spot_id") `);
        await queryRunner.query(`ALTER TABLE "customers" ADD CONSTRAINT "UQ_e117eaee19f688d791c0bb87dad" UNIQUE ("company_id", "document_type", "document_number")`);
        await queryRunner.query(`ALTER TABLE "parking_zones" ADD CONSTRAINT "UQ_01ffe70bd994449018278c68211" UNIQUE ("parking_lot_id", "name")`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "UQ_23b6d9c1a3c18f435cee5bdad0f" UNIQUE ("parking_lot_id", "code")`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ADD CONSTRAINT "FK_50d854b973295d7c51bcf346efe" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ADD CONSTRAINT "FK_46fc7d733187f3afd98adfe64a1" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ADD CONSTRAINT "FK_f160d97a931844109de9d04228f" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "users" ADD CONSTRAINT "FK_7ae6334059289559722437bcc1c" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "users" ADD CONSTRAINT "FK_06c2e305ee06aedfe649b74ef66" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "tickets" ADD CONSTRAINT "FK_b919a0e8391a5bb96e9ee392fbe" FOREIGN KEY ("entry_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "tickets" ADD CONSTRAINT "FK_3023efeb0eba7982352d958ef42" FOREIGN KEY ("exit_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_lots" ADD CONSTRAINT "FK_bee9424473a42c5f5abb4737411" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "consents" ADD CONSTRAINT "FK_ab17d59cc4f5a409bce5f02d81c" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "consents" ADD CONSTRAINT "FK_1e122f028151e9729b41c79be81" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "consents" ADD CONSTRAINT "FK_d25ddf287d5ee710a230924f93e" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "customers" ADD CONSTRAINT "FK_f0e29920aaf871f3eddbea69f0d" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ADD CONSTRAINT "FK_277979f4823d837c77b53a122af" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ADD CONSTRAINT "FK_f621a5e458e944d0b2542433653" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" ADD CONSTRAINT "FK_2710b2768d3e27a419090d0890d" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" ADD CONSTRAINT "FK_781bad2f6840fcade63a5cc3e01" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_zones" ADD CONSTRAINT "FK_31110f9477e968876568dc9b4a4" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_zones" ADD CONSTRAINT "FK_4c4edef2d4c0a70ce290a8a05ab" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "FK_f5b416c56d83c51e43806dd3211" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "FK_0e9f64169bf505b8f113edc0689" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "FK_94850016cd36b802800c88a47ae" FOREIGN KEY ("zone_id") REFERENCES "parking_zones"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_15b0e7939fff3161fcb306e3dcd" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_261eab8e127579ec82ab6efb6ac" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_bd16a3aebcbd31d12e8f1e4240e" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_cf0c504ea503ea443e9e55724c1" FOREIGN KEY ("vehicle_id") REFERENCES "vehicles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_f1ada1bc514cc7bd3ab71f58b2e" FOREIGN KEY ("spot_id") REFERENCES "parking_spots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_be3f04bdbb4327e155358a37249" FOREIGN KEY ("created_by_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_90add71000196cbc19f340dd767" FOREIGN KEY ("closed_by_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "FK_5351de8a1dd4e582c9787298fd8" FOREIGN KEY ("canceled_by_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "FK_d59edea663601fbff030a002bfb" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "FK_ba54ae3cc7814089ec771eb0336" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "FK_4804e1b2fbc329f5a2c7b61860b" FOREIGN KEY ("parking_session_id") REFERENCES "parking_sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "FK_cf533adf3ef88df449863ded2ae" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_0778f9142420e9fbe4527a0cd8d" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_ea6685b4b0acaff738b9cdfd05b" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_f5aabc8eeb95d69daa17368d468" FOREIGN KEY ("spot_id") REFERENCES "parking_spots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_6832dee980d6654492ba23bfce0" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" ADD CONSTRAINT "FK_6e0056e4bf2e86e0d5669436624" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "FK_b7760dc69c7c0e7756ce3a2af1d" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "FK_0264d6a63236926b60469de9051" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "FK_3323e013b3963f3fb9f86a6cc44" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "FK_e593621608e3fb83ac7814d0069" FOREIGN KEY ("vehicle_id") REFERENCES "vehicles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "FK_6b2c0c5332c798bf3c8970e0bf6" FOREIGN KEY ("parking_session_id") REFERENCES "parking_sessions"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "FK_6b2c0c5332c798bf3c8970e0bf6"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "FK_e593621608e3fb83ac7814d0069"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "FK_3323e013b3963f3fb9f86a6cc44"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "FK_0264d6a63236926b60469de9051"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP CONSTRAINT "FK_b7760dc69c7c0e7756ce3a2af1d"`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" DROP CONSTRAINT "FK_6e0056e4bf2e86e0d5669436624"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_6832dee980d6654492ba23bfce0"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_f5aabc8eeb95d69daa17368d468"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_ea6685b4b0acaff738b9cdfd05b"`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" DROP CONSTRAINT "FK_0778f9142420e9fbe4527a0cd8d"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "FK_cf533adf3ef88df449863ded2ae"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "FK_4804e1b2fbc329f5a2c7b61860b"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "FK_ba54ae3cc7814089ec771eb0336"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP CONSTRAINT "FK_d59edea663601fbff030a002bfb"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_5351de8a1dd4e582c9787298fd8"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_90add71000196cbc19f340dd767"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_be3f04bdbb4327e155358a37249"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_f1ada1bc514cc7bd3ab71f58b2e"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_cf0c504ea503ea443e9e55724c1"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_bd16a3aebcbd31d12e8f1e4240e"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_261eab8e127579ec82ab6efb6ac"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "FK_15b0e7939fff3161fcb306e3dcd"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "FK_94850016cd36b802800c88a47ae"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "FK_0e9f64169bf505b8f113edc0689"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "FK_f5b416c56d83c51e43806dd3211"`);
        await queryRunner.query(`ALTER TABLE "parking_zones" DROP CONSTRAINT "FK_4c4edef2d4c0a70ce290a8a05ab"`);
        await queryRunner.query(`ALTER TABLE "parking_zones" DROP CONSTRAINT "FK_31110f9477e968876568dc9b4a4"`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" DROP CONSTRAINT "FK_781bad2f6840fcade63a5cc3e01"`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" DROP CONSTRAINT "FK_2710b2768d3e27a419090d0890d"`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" DROP CONSTRAINT "FK_f621a5e458e944d0b2542433653"`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" DROP CONSTRAINT "FK_277979f4823d837c77b53a122af"`);
        await queryRunner.query(`ALTER TABLE "customers" DROP CONSTRAINT "FK_f0e29920aaf871f3eddbea69f0d"`);
        await queryRunner.query(`ALTER TABLE "consents" DROP CONSTRAINT "FK_d25ddf287d5ee710a230924f93e"`);
        await queryRunner.query(`ALTER TABLE "consents" DROP CONSTRAINT "FK_1e122f028151e9729b41c79be81"`);
        await queryRunner.query(`ALTER TABLE "consents" DROP CONSTRAINT "FK_ab17d59cc4f5a409bce5f02d81c"`);
        await queryRunner.query(`ALTER TABLE "parking_lots" DROP CONSTRAINT "FK_bee9424473a42c5f5abb4737411"`);
        await queryRunner.query(`ALTER TABLE "tickets" DROP CONSTRAINT "FK_3023efeb0eba7982352d958ef42"`);
        await queryRunner.query(`ALTER TABLE "tickets" DROP CONSTRAINT "FK_b919a0e8391a5bb96e9ee392fbe"`);
        await queryRunner.query(`ALTER TABLE "users" DROP CONSTRAINT "FK_06c2e305ee06aedfe649b74ef66"`);
        await queryRunner.query(`ALTER TABLE "users" DROP CONSTRAINT "FK_7ae6334059289559722437bcc1c"`);
        await queryRunner.query(`ALTER TABLE "audit_logs" DROP CONSTRAINT "FK_f160d97a931844109de9d04228f"`);
        await queryRunner.query(`ALTER TABLE "audit_logs" DROP CONSTRAINT "FK_46fc7d733187f3afd98adfe64a1"`);
        await queryRunner.query(`ALTER TABLE "audit_logs" DROP CONSTRAINT "FK_50d854b973295d7c51bcf346efe"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" DROP CONSTRAINT "UQ_23b6d9c1a3c18f435cee5bdad0f"`);
        await queryRunner.query(`ALTER TABLE "parking_zones" DROP CONSTRAINT "UQ_01ffe70bd994449018278c68211"`);
        await queryRunner.query(`ALTER TABLE "customers" DROP CONSTRAINT "UQ_e117eaee19f688d791c0bb87dad"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f5aabc8eeb95d69daa17368d46"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_ea6685b4b0acaff738b9cdfd05"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_0778f9142420e9fbe4527a0cd8"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_07bb10fe9879ba1639bf941936"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f5aabc8eeb95d69daa17368d46"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_ea6685b4b0acaff738b9cdfd05"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_0778f9142420e9fbe4527a0cd8"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_0e9f64169bf505b8f113edc068"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f5b416c56d83c51e43806dd321"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_94850016cd36b802800c88a47a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_5ef9ec08f6be37cd24837fd087"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_3ae61187fe941f63c7804db1a0"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_a1e809ee6c0f1ac5a4526c1977"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_94850016cd36b802800c88a47a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_0e9f64169bf505b8f113edc068"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f5b416c56d83c51e43806dd321"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_4c4edef2d4c0a70ce290a8a05a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_31110f9477e968876568dc9b4a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_4c4edef2d4c0a70ce290a8a05a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_31110f9477e968876568dc9b4a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_155d86702a10041d294f9fde38"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_21ddbf10f881dc82b7f8b0187a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_22b98dcb177bd6261887c8c959"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_bf14b22e55d577d5834fcf886b"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_88acd889fbe17d0e16cc4bc917"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_8536b8b85c06969f84f0c098b0"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_94aa5f1969303fa5e12fe6b28d"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_ca777b57c4b673cd7ba0e6a5cb"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_3dacbb3eb4f095e29372ff8e13"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_bee9424473a42c5f5abb473741"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_97672ac88f789774dd47f7c8be"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_7ae6334059289559722437bcc1"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_06c2e305ee06aedfe649b74ef6"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_50d854b973295d7c51bcf346ef"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_46fc7d733187f3afd98adfe64a"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_f160d97a931844109de9d04228"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_4057c4849108f6d6ccb77a4e91"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_2cd10fda8276bb995288acfbfb"`);
        await queryRunner.query(`CREATE TYPE "public"."notification_status_enum_old" AS ENUM('QUEUED', 'SENT', 'FAILED')`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ALTER COLUMN "status" DROP DEFAULT`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ALTER COLUMN "status" TYPE "public"."notification_status_enum_old" USING "status"::"text"::"public"."notification_status_enum_old"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ALTER COLUMN "status" SET DEFAULT 'QUEUED'`);
        await queryRunner.query(`DROP TYPE "public"."notification_status_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."notification_status_enum_old" RENAME TO "notification_status_enum"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP CONSTRAINT "UQ_89db57d0a4ef57532f9d0040ccb"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ALTER COLUMN "spot_id" DROP NOT NULL`);
        await queryRunner.query(`CREATE TYPE "public"."vehicle_type_v2_enum_old" AS ENUM('BICYCLE', 'MOTORCYCLE', 'CAR', 'TRUCK_BUS')`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ALTER COLUMN "vehicle_type" TYPE "public"."vehicle_type_v2_enum_old" USING "vehicle_type"::"text"::"public"."vehicle_type_v2_enum_old"`);
        await queryRunner.query(`DROP TYPE "public"."vehicles_v2_vehicle_type_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."vehicle_type_v2_enum_old" RENAME TO "vehicle_type_v2_enum"`);
        await queryRunner.query(`CREATE TYPE "public"."document_type_enum_old" AS ENUM('CC', 'CE', 'PASSPORT', 'PPT', 'OTHER')`);
        await queryRunner.query(`ALTER TABLE "customers" ALTER COLUMN "document_type" TYPE "public"."document_type_enum_old" USING "document_type"::"text"::"public"."document_type_enum_old"`);
        await queryRunner.query(`DROP TYPE "public"."customers_document_type_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."document_type_enum_old" RENAME TO "document_type_enum"`);
        await queryRunner.query(`CREATE TYPE "public"."consent_source_enum_old" AS ENUM('IN_PERSON', 'WEB', 'CALLCENTER', 'OTHER')`);
        await queryRunner.query(`ALTER TABLE "consents" ALTER COLUMN "source" TYPE "public"."consent_source_enum_old" USING "source"::"text"::"public"."consent_source_enum_old"`);
        await queryRunner.query(`DROP TYPE "public"."consents_source_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."consent_source_enum_old" RENAME TO "consent_source_enum"`);
        await queryRunner.query(`CREATE TYPE "public"."consent_status_enum_old" AS ENUM('GRANTED', 'REVOKED')`);
        await queryRunner.query(`ALTER TABLE "consents" ALTER COLUMN "status" TYPE "public"."consent_status_enum_old" USING "status"::"text"::"public"."consent_status_enum_old"`);
        await queryRunner.query(`DROP TYPE "public"."consents_status_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."consent_status_enum_old" RENAME TO "consent_status_enum"`);
        await queryRunner.query(`CREATE TYPE "public"."consent_channel_enum_old" AS ENUM('WHATSAPP', 'EMAIL')`);
        await queryRunner.query(`ALTER TABLE "consents" ALTER COLUMN "channel" TYPE "public"."consent_channel_enum_old" USING "channel"::"text"::"public"."consent_channel_enum_old"`);
        await queryRunner.query(`DROP TYPE "public"."consents_channel_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."consent_channel_enum_old" RENAME TO "consent_channel_enum"`);
        await queryRunner.query(`ALTER TABLE "vehicles" ALTER COLUMN "updated_at" SET DEFAULT CURRENT_TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "vehicles" ALTER COLUMN "created_at" SET DEFAULT CURRENT_TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "tickets" ALTER COLUMN "updated_at" SET DEFAULT CURRENT_TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "tickets" ALTER COLUMN "created_at" SET DEFAULT CURRENT_TIMESTAMP`);
        await queryRunner.query(`CREATE TYPE "public"."user_role_enum_old" AS ENUM('ADMIN', 'SUPERVISOR', 'CASHIER')`);
        await queryRunner.query(`ALTER TABLE "users" ALTER COLUMN "role" DROP DEFAULT`);
        await queryRunner.query(`ALTER TABLE "users" ALTER COLUMN "role" TYPE "public"."user_role_enum_old" USING "role"::"text"::"public"."user_role_enum_old"`);
        await queryRunner.query(`ALTER TABLE "users" ALTER COLUMN "role" SET DEFAULT 'CASHIER'`);
        await queryRunner.query(`DROP TYPE "public"."users_role_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."user_role_enum_old" RENAME TO "user_role_enum"`);
        await queryRunner.query(`CREATE TYPE "public"."audit_action_enum_old" AS ENUM('CREATE', 'UPDATE', 'DELETE', 'RESTORE', 'LOGIN')`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ALTER COLUMN "action" TYPE "public"."audit_action_enum_old" USING "action"::"text"::"public"."audit_action_enum_old"`);
        await queryRunner.query(`DROP TYPE "public"."audit_logs_action_enum"`);
        await queryRunner.query(`ALTER TYPE "public"."audit_action_enum_old" RENAME TO "audit_action_enum"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "sent_at"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "message"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "subject"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "recipient"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "type"`);
        await queryRunner.query(`DROP TYPE "public"."notification_type_enum"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "session_id"`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" DROP COLUMN "current_number"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "canceled_by_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "canceled_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "notes"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "email"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "phone_number"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "check_out_operator_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "operator_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "duration_minutes"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "check_out_time"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "check_in_time"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "vehicle_type"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "vehicle_plate"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "operator_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "print_type"`);
        await queryRunner.query(`DROP TYPE "public"."print_type_enum"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "ticket_content"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "session_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "created_at"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "payload"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "provider"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "template"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "to"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "channel"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "parking_session_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "vehicle_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "customer_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "parking_lot_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" DROP COLUMN "next_ticket_number"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "device_name"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "reason"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "actor_user_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "action"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "parking_session_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "parking_lot_id"`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "ticket_reprinted_count"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "ticket_printed_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "canceled_by_user_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "closed_by_user_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "created_by_user_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "exit_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "entry_at"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "vehicle_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "customer_id"`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "updated_at" TIMESTAMP NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "created_at" TIMESTAMP NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "payload" jsonb`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "provider" character varying(100) NOT NULL DEFAULT 'mock'`);
        await queryRunner.query(`CREATE TYPE "public"."notification_template_enum" AS ENUM('ENTRY', 'EXIT', 'INVOICE')`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "template" "public"."notification_template_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "to" character varying(255) NOT NULL`);
        await queryRunner.query(`CREATE TYPE "public"."notification_channel_enum" AS ENUM('WHATSAPP', 'EMAIL')`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "channel" "public"."notification_channel_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "parking_session_id" uuid`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "vehicle_id" uuid`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "customer_id" uuid`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "parking_lot_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "ticket_reprinted_count" integer NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "ticket_printed_at" TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "canceled_by_user_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "closed_by_user_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "created_by_user_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "exit_at" TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "entry_at" TIMESTAMP NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "vehicle_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "customer_id" uuid`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "device_name" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "reason" text`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "actor_user_id" uuid NOT NULL`);
        await queryRunner.query(`CREATE TYPE "public"."ticket_print_action_enum" AS ENUM('PRINT', 'REPRINT')`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "action" "public"."ticket_print_action_enum" NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "parking_session_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "parking_lot_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" ADD "current_number" integer NOT NULL DEFAULT '1'`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" RENAME COLUMN "current_number" TO "next_ticket_number"`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "UQ_parking_spots_parking_lot_code" UNIQUE ("parking_lot_id", "code")`);
        await queryRunner.query(`ALTER TABLE "parking_zones" ADD CONSTRAINT "UQ_parking_zones_parking_lot_name" UNIQUE ("parking_lot_id", "name")`);
        await queryRunner.query(`ALTER TABLE "customers" ADD CONSTRAINT "customers_company_id_document_type_document_number_key" UNIQUE ("company_id", "document_type", "document_number")`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ADD CONSTRAINT "check_vehicle_identifier" CHECK ((((vehicle_type = 'BICYCLE'::vehicle_type_v2_enum) AND (bicycle_code IS NOT NULL) AND (plate IS NULL)) OR ((vehicle_type <> 'BICYCLE'::vehicle_type_v2_enum) AND (plate IS NOT NULL) AND (bicycle_code IS NULL))))`);
        await queryRunner.query(`CREATE INDEX "idx_notification_logs_status" ON "notification_logs" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_notification_logs_parking_lot" ON "notification_logs" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "idx_parking_lot_counters_parking_lot_id" ON "parking_lot_counters" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_spot_status_history_created_at" ON "spot_status_history" ("created_at") `);
        await queryRunner.query(`CREATE INDEX "IDX_spot_status_history_spot_id" ON "spot_status_history" ("spot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_spot_status_history_parking_lot_id" ON "spot_status_history" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_spot_status_history_company_id" ON "spot_status_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_ticket_print_logs_parking_lot" ON "ticket_print_logs" ("parking_lot_id", "printed_at") `);
        await queryRunner.query(`CREATE INDEX "idx_ticket_print_logs_session" ON "ticket_print_logs" ("parking_session_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "idx_parking_sessions_ticket_number" ON "parking_sessions" ("parking_lot_id", "ticket_number") `);
        await queryRunner.query(`CREATE INDEX "idx_parking_sessions_spot_active" ON "parking_sessions" ("spot_id") WHERE (status = 'ACTIVE'::parking_session_status_enum)`);
        await queryRunner.query(`CREATE INDEX "idx_parking_sessions_vehicle_active" ON "parking_sessions" ("vehicle_id") WHERE (status = 'ACTIVE'::parking_session_status_enum)`);
        await queryRunner.query(`CREATE INDEX "idx_parking_sessions_parking_lot_status" ON "parking_sessions" ("parking_lot_id", "status") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_spots_code" ON "parking_spots" ("code") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_spots_spot_type" ON "parking_spots" ("spot_type") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_spots_status" ON "parking_spots" ("status") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_spots_zone_id" ON "parking_spots" ("zone_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_spots_parking_lot_id" ON "parking_spots" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_spots_company_id" ON "parking_spots" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_zones_parking_lot_id" ON "parking_zones" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_zones_company_id" ON "parking_zones" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_ticket_templates_parking_lot" ON "ticket_templates" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "idx_vehicles_v2_bicycle_code_search" ON "vehicles_v2" ("bicycle_code") `);
        await queryRunner.query(`CREATE INDEX "idx_vehicles_v2_plate_search" ON "vehicles_v2" ("plate") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "idx_vehicles_v2_bicycle_code" ON "vehicles_v2" ("company_id", "bicycle_code") WHERE (bicycle_code IS NOT NULL)`);
        await queryRunner.query(`CREATE UNIQUE INDEX "idx_vehicles_v2_plate" ON "vehicles_v2" ("company_id", "plate") WHERE (plate IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_customers_email" ON "customers" ("email") `);
        await queryRunner.query(`CREATE INDEX "idx_customers_phone" ON "customers" ("phone") `);
        await queryRunner.query(`CREATE INDEX "idx_customers_full_name" ON "customers" ("full_name") `);
        await queryRunner.query(`CREATE INDEX "idx_customers_document_number" ON "customers" ("document_number") `);
        await queryRunner.query(`CREATE INDEX "idx_consents_status" ON "consents" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_consents_customer_channel" ON "consents" ("customer_id", "channel") `);
        await queryRunner.query(`CREATE INDEX "idx_vehicles_license_plate" ON "vehicles" ("license_plate") `);
        await queryRunner.query(`CREATE INDEX "idx_vehicles_company_id" ON "vehicles" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_companies_name" ON "companies" ("name") `);
        await queryRunner.query(`CREATE INDEX "IDX_parking_lots_company_id" ON "parking_lots" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_tickets_entry_time" ON "tickets" ("entry_time") `);
        await queryRunner.query(`CREATE INDEX "idx_tickets_status" ON "tickets" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_tickets_parking_lot_id" ON "tickets" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "idx_tickets_vehicle_id" ON "tickets" ("vehicle_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_users_parking_lot_id" ON "users" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_users_company_id" ON "users" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_users_email" ON "users" ("email") `);
        await queryRunner.query(`CREATE INDEX "IDX_audit_logs_created_at" ON "audit_logs" ("created_at") `);
        await queryRunner.query(`CREATE INDEX "IDX_audit_logs_entity_name" ON "audit_logs" ("entity_name") `);
        await queryRunner.query(`CREATE INDEX "IDX_audit_logs_actor_user_id" ON "audit_logs" ("actor_user_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_audit_logs_parking_lot_id" ON "audit_logs" ("parking_lot_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_audit_logs_company_id" ON "audit_logs" ("company_id") `);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "notification_logs_parking_session_id_fkey" FOREIGN KEY ("parking_session_id") REFERENCES "parking_sessions"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "notification_logs_vehicle_id_fkey" FOREIGN KEY ("vehicle_id") REFERENCES "vehicles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "notification_logs_customer_id_fkey" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "notification_logs_parking_lot_id_fkey" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "notification_logs" ADD CONSTRAINT "notification_logs_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_lot_counters" ADD CONSTRAINT "parking_lot_counters_parking_lot_id_fkey" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_spot_status_history_actor" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_spot_status_history_spot" FOREIGN KEY ("spot_id") REFERENCES "parking_spots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_spot_status_history_parking_lot" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "spot_status_history" ADD CONSTRAINT "FK_spot_status_history_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "ticket_print_logs_actor_user_id_fkey" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "ticket_print_logs_parking_session_id_fkey" FOREIGN KEY ("parking_session_id") REFERENCES "parking_sessions"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "ticket_print_logs_parking_lot_id_fkey" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_print_logs" ADD CONSTRAINT "ticket_print_logs_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_canceled_by_user_id_fkey" FOREIGN KEY ("canceled_by_user_id") REFERENCES "users"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_closed_by_user_id_fkey" FOREIGN KEY ("closed_by_user_id") REFERENCES "users"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_created_by_user_id_fkey" FOREIGN KEY ("created_by_user_id") REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_spot_id_fkey" FOREIGN KEY ("spot_id") REFERENCES "parking_spots"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_vehicle_id_fkey" FOREIGN KEY ("vehicle_id") REFERENCES "vehicles"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_customer_id_fkey" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_parking_lot_id_fkey" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_sessions" ADD CONSTRAINT "parking_sessions_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "FK_parking_spots_zone" FOREIGN KEY ("zone_id") REFERENCES "parking_zones"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "FK_parking_spots_parking_lot" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_spots" ADD CONSTRAINT "FK_parking_spots_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_zones" ADD CONSTRAINT "FK_parking_zones_parking_lot" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_zones" ADD CONSTRAINT "FK_parking_zones_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" ADD CONSTRAINT "ticket_templates_parking_lot_id_fkey" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "ticket_templates" ADD CONSTRAINT "ticket_templates_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ADD CONSTRAINT "vehicles_v2_customer_id_fkey" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "vehicles_v2" ADD CONSTRAINT "vehicles_v2_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "customers" ADD CONSTRAINT "customers_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "consents" ADD CONSTRAINT "consents_actor_user_id_fkey" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "consents" ADD CONSTRAINT "consents_customer_id_fkey" FOREIGN KEY ("customer_id") REFERENCES "customers"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "consents" ADD CONSTRAINT "consents_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "parking_lots" ADD CONSTRAINT "FK_parking_lots_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "tickets" ADD CONSTRAINT "FK_3023efeb0eba7982352d958ef42" FOREIGN KEY ("exit_user_id") REFERENCES "users"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "tickets" ADD CONSTRAINT "FK_b919a0e8391a5bb96e9ee392fbe" FOREIGN KEY ("entry_user_id") REFERENCES "users"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "users" ADD CONSTRAINT "FK_users_parking_lot" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "users" ADD CONSTRAINT "FK_users_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ADD CONSTRAINT "FK_audit_logs_actor_user" FOREIGN KEY ("actor_user_id") REFERENCES "users"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ADD CONSTRAINT "FK_audit_logs_parking_lot" FOREIGN KEY ("parking_lot_id") REFERENCES "parking_lots"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "audit_logs" ADD CONSTRAINT "FK_audit_logs_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
    }

}
